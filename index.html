<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZigZag Prompts</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Icons (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Fonts: Unbounded (Y2K style), Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&family=Unbounded:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        /* Custom Font Loading - Simulating Milker with Unbounded */
        :root {
            --font-display: 'Unbounded', sans-serif;
            --font-body: 'Poppins', sans-serif;
            --color-primary: #5C5CFF;
        }

        body {
            background-color: #050505;
            color: #ffffff;
            font-family: var(--font-body);
            overflow-x: hidden;
        }

        /* Y2K Glassmorphism */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .glass-button {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }

        .glass-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .gradient-text {
            background: linear-gradient(90deg, #fff, #aaa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Hide scrollbar for cleaner look */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #000;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 3px;
        }

        .aspect-ratio-4-5 {
            aspect-ratio: 4 / 5;
        }
        
        .font-y2k { font-family: var(--font-display); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Mock Data ---
        const initialPrompts = [
            {
                id: '1',
                title: 'Harry Potter Style',
                image: 'https://images.unsplash.com/photo-1542206391-7f9492806141?q=80&w=1287&auto=format&fit=crop',
                prompt: 'Transform the subject into a character from the Harry Potter universe, matching them to the Hogwarts house they visually belong to based on aura and style. Cinematic Harry Potter film look, detailed, realistic portrait lighting. Dress the subject in Hogwarts uniform with colored robes. 4k resolution.',
                category: 'NanoBanana',
            },
            {
                id: '2',
                title: 'Winter Aesthetic',
                image: 'https://images.unsplash.com/photo-1483985988355-763728e1935b?q=80&w=2070&auto=format&fit=crop',
                prompt: 'A hyper-realistic portrait of a girl in a snowy forest, wearing a green puffer jacket and beanie. Soft morning sunlight filtering through trees, mist, frost on eyelashes, 8k resolution, cinematic depth of field.',
                category: 'Midjourney',
            }
        ];

        // --- Components ---

        const Tag = ({ category }) => {
            let colorClass = "text-white";
            let dotColor = "bg-white";

            if (category === 'NanoBanana') {
                colorClass = "text-yellow-400";
                dotColor = "bg-yellow-400";
            } else if (category === 'Midjourney') {
                colorClass = "text-blue-400";
                dotColor = "bg-blue-400";
            } else if (category === 'Seedream') {
                colorClass = "text-green-400";
                dotColor = "bg-green-400";
            }

            return (
                <div className="flex items-center gap-2 bg-black/40 px-3 py-1.5 rounded-full border border-white/10 w-fit">
                    <span className={`w-2 h-2 rounded-full ${dotColor}`}></span>
                    <span className={`text-xs font-y2k font-bold uppercase tracking-wider ${colorClass}`}>{category}</span>
                </div>
            );
        };

        const App = () => {
            const [prompts, setPrompts] = useState(initialPrompts);
            const [view, setView] = useState('gallery'); // gallery, full, add, edit
            const [activePrompt, setActivePrompt] = useState(null);
            const [filter, setFilter] = useState('All');
            const [isSharedMode, setIsSharedMode] = useState(false);

            // Check URL for shared ID on load
            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const sharedId = params.get('share');
                
                if (sharedId) {
                    const found = prompts.find(p => p.id === sharedId);
                    if (found) {
                        setActivePrompt(found);
                        setView('full');
                        setIsSharedMode(true);
                    }
                }
                lucide.createIcons();
            }, []);

            useEffect(() => {
                lucide.createIcons();
            }, [view, prompts]);

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text);
                alert("Prompt copied to clipboard!");
            };

            const sharePrompt = (id) => {
                // Simulate generating a share link
                const url = `${window.location.origin}${window.location.pathname}?share=${id}`;
                navigator.clipboard.writeText(url);
                alert("Share link copied! Send this link to anyone.");
            };

            const handleSave = (newPrompt) => {
                if (view === 'add') {
                    setPrompts([...prompts, { ...newPrompt, id: Date.now().toString() }]);
                } else if (view === 'edit') {
                    setPrompts(prompts.map(p => p.id === activePrompt.id ? { ...newPrompt, id: activePrompt.id } : p));
                }
                setView('gallery');
                setActivePrompt(null);
            };

            const handleDelete = (id) => {
                 if(confirm("Delete this prompt?")) {
                    setPrompts(prompts.filter(p => p.id !== id));
                    setView('gallery');
                 }
            }

            const filteredPrompts = filter === 'All' 
                ? prompts 
                : prompts.filter(p => p.category === filter);

            // --- FULL VIEW (POPUP) ---
            if (view === 'full' && activePrompt) {
                return (
                    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/95 p-4 overflow-y-auto">
                        <div className="w-full max-w-lg glass-panel rounded-3xl overflow-hidden relative flex flex-col max-h-[90vh]">
                            
                            {/* Header inside Modal */}
                            <div className="absolute top-0 left-0 right-0 z-10 p-6 flex justify-between items-start bg-gradient-to-b from-black/80 to-transparent">
                                {!isSharedMode && (
                                    <button 
                                        onClick={() => { setView('gallery'); setActivePrompt(null); }}
                                        className="w-10 h-10 rounded-full glass-button flex items-center justify-center text-white"
                                    >
                                        <i data-lucide="arrow-left" className="w-5 h-5"></i>
                                    </button>
                                )}
                                <div className="flex-1"></div>
                            </div>

                            {/* Scrollable Content */}
                            <div className="overflow-y-auto custom-scrollbar pb-24">
                                {/* Image Container */}
                                <div className="relative w-full aspect-ratio-4-5 bg-gray-900">
                                    <img 
                                        src={activePrompt.image} 
                                        alt={activePrompt.title} 
                                        className="w-full h-full object-cover"
                                    />
                                    <div className="absolute bottom-4 right-4">
                                         {/* Small corner previews removed as per request, kept clean */}
                                    </div>
                                </div>

                                {/* Content Body */}
                                <div className="p-6 space-y-4">
                                    <div className="flex flex-col items-center justify-center gap-2 mb-2">
                                         {/* Logo above title */}
                                         <div className="w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center overflow-hidden">
                                            <img src="https://zig-zag.co/favicon.ico" onError={(e)=>{e.target.style.display='none'}} className="w-6 h-6 object-contain"/>
                                            <span className="font-y2k text-xs">ZZ</span> 
                                         </div>
                                         <h1 className="text-2xl font-y2k font-bold text-center">{activePrompt.title}</h1>
                                    </div>

                                    <Tag category={activePrompt.category} />
                                    
                                    <div className="glass-panel p-4 rounded-xl mt-4">
                                        <p className="text-gray-300 text-sm leading-relaxed font-light">
                                            {activePrompt.prompt}
                                        </p>
                                    </div>
                                </div>
                            </div>

                            {/* Sticky Bottom Button */}
                            <div className="absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black via-black/90 to-transparent">
                                <button 
                                    onClick={() => copyToClipboard(activePrompt.prompt)}
                                    className="w-full py-4 rounded-full font-bold font-body text-white flex items-center justify-center gap-2 hover:opacity-90 transition-opacity"
                                    style={{ backgroundColor: '#5C5CFF' }}
                                >
                                    <i data-lucide="copy" className="w-4 h-4"></i>
                                    Copy Prompt
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // --- ADD / EDIT FORM ---
            if (view === 'add' || view === 'edit') {
                return <PromptForm 
                    initialData={view === 'edit' ? activePrompt : null} 
                    onSave={handleSave} 
                    onCancel={() => setView('gallery')} 
                />
            }

            // --- GALLERY VIEW (Shared Mode hides this completely, but logically we rendered Full View above if active) ---
            if (isSharedMode) return null; 

            return (
                <div className="min-h-screen pb-20 p-4 md:p-8 max-w-7xl mx-auto">
                    {/* Header */}
                    <header className="flex justify-between items-center mb-8">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 bg-white rounded-lg flex items-center justify-center text-black font-y2k font-bold text-xl">
                                Z
                            </div>
                            <span className="text-xl font-y2k tracking-tight">ZigZag</span>
                        </div>
                        <button 
                            onClick={() => setView('add')}
                            className="px-5 py-2 rounded-full glass-button text-sm font-medium flex items-center gap-2"
                        >
                            <i data-lucide="plus" className="w-4 h-4"></i>
                            Add Prompt
                        </button>
                    </header>

                    {/* Filter Tabs */}
                    <div className="flex gap-3 overflow-x-auto pb-4 mb-6 no-scrollbar">
                        {['All', 'NanoBanana', 'Midjourney', 'Seedream'].map(cat => (
                            <button
                                key={cat}
                                onClick={() => setFilter(cat)}
                                className={`px-4 py-2 rounded-full text-xs font-y2k uppercase transition-all whitespace-nowrap border ${
                                    filter === cat 
                                    ? 'bg-white text-black border-white' 
                                    : 'bg-transparent text-gray-400 border-gray-700 hover:border-gray-500'
                                }`}
                            >
                                {cat}
                            </button>
                        ))}
                    </div>

                    {/* Grid */}
                    <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                        {filteredPrompts.map(item => (
                            <div key={item.id} className="flex flex-col gap-3 group">
                                {/* Card Clickable Area */}
                                <div 
                                    onClick={() => { setActivePrompt(item); setView('full'); }}
                                    className="glass-panel rounded-3xl overflow-hidden aspect-ratio-4-5 relative cursor-pointer group-hover:border-white/30 transition-all"
                                >
                                    <img 
                                        src={item.image} 
                                        alt={item.title} 
                                        className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                                    />
                                    {/* Overlay Gradient */}
                                    <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60"></div>
                                    
                                    <div className="absolute bottom-0 left-0 p-4 w-full">
                                        <h3 className="font-y2k text-lg leading-tight mb-2 truncate">{item.title}</h3>
                                        <Tag category={item.category} />
                                    </div>
                                </div>

                                {/* Actions Below Card (Only for Owner) */}
                                <div className="flex gap-2 px-1">
                                    <button 
                                        onClick={() => { setActivePrompt(item); setView('edit'); }}
                                        className="flex-1 py-2 rounded-xl glass-button flex items-center justify-center gap-2 text-xs text-gray-300 hover:text-white"
                                    >
                                        <i data-lucide="edit-3" className="w-3 h-3"></i>
                                        Edit
                                    </button>
                                    <button 
                                        onClick={() => sharePrompt(item.id)}
                                        className="flex-1 py-2 rounded-xl glass-button flex items-center justify-center gap-2 text-xs text-gray-300 hover:text-white"
                                    >
                                        <i data-lucide="share-2" className="w-3 h-3"></i>
                                        Share
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // --- FORM COMPONENT ---
        const PromptForm = ({ initialData, onSave, onCancel }) => {
            const [formData, setFormData] = useState(initialData || {
                title: '',
                prompt: '',
                image: '',
                category: 'NanoBanana'
            });

            return (
                <div className="min-h-screen p-6 flex flex-col max-w-2xl mx-auto">
                    <h2 className="text-2xl font-y2k mb-6">{initialData ? 'Edit Prompt' : 'New Prompt'}</h2>
                    
                    <div className="space-y-4 flex-1">
                        <div>
                            <label className="block text-xs text-gray-400 mb-2 uppercase tracking-wider">Title</label>
                            <input 
                                type="text" 
                                className="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:outline-none focus:border-[#5C5CFF]"
                                value={formData.title}
                                onChange={e => setFormData({...formData, title: e.target.value})}
                                placeholder="e.g. Cyberpunk City"
                            />
                        </div>

                        <div>
                            <label className="block text-xs text-gray-400 mb-2 uppercase tracking-wider">Image URL</label>
                            <input 
                                type="text" 
                                className="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:outline-none focus:border-[#5C5CFF]"
                                value={formData.image}
                                onChange={e => setFormData({...formData, image: e.target.value})}
                                placeholder="https://..."
                            />
                        </div>

                         <div>
                            <label className="block text-xs text-gray-400 mb-2 uppercase tracking-wider">Category</label>
                            <div className="flex gap-2">
                                {['NanoBanana', 'Midjourney', 'Seedream'].map(cat => (
                                    <button
                                        key={cat}
                                        onClick={() => setFormData({...formData, category: cat})}
                                        className={`px-4 py-2 rounded-lg text-xs border ${
                                            formData.category === cat 
                                            ? 'bg-white/20 border-white text-white' 
                                            : 'bg-transparent border-white/10 text-gray-500'
                                        }`}
                                    >
                                        {cat}
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div>
                            <label className="block text-xs text-gray-400 mb-2 uppercase tracking-wider">Prompt</label>
                            <textarea 
                                className="w-full h-40 bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:outline-none focus:border-[#5C5CFF] resize-none"
                                value={formData.prompt}
                                onChange={e => setFormData({...formData, prompt: e.target.value})}
                                placeholder="Enter prompt details..."
                            ></textarea>
                        </div>
                    </div>

                    <div className="flex gap-4 mt-8">
                        <button 
                            onClick={onCancel}
                            className="flex-1 py-3 rounded-full glass-button text-gray-300 font-medium"
                        >
                            Cancel
                        </button>
                        <button 
                            onClick={() => onSave(formData)}
                            className="flex-1 py-3 rounded-full text-white font-bold"
                            style={{ backgroundColor: '#5C5CFF' }}
                        >
                            Save Prompt
                        </button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
