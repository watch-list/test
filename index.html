<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PromptVault</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Icons (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Fonts: Unbounded (Y2K style), Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&family=Unbounded:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --font-display: 'Unbounded', sans-serif;
            --font-body: 'Poppins', sans-serif;
            --color-primary: #5C5CFF;
        }

        body {
            background-color: #050505;
            color: #ffffff;
            font-family: var(--font-body);
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* Y2K Glassmorphism */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .glass-button {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }

        .glass-button:active {
            transform: scale(0.98);
        }

        /* Hide scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .aspect-ratio-4-5 { aspect-ratio: 4 / 5; }
        .font-y2k { font-family: var(--font-display); }
        
        /* Mobile Optimizations */
        input, textarea { font-size: 16px !important; } 
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Default Data ---
        const defaultPrompts = [
            {
                id: '1',
                title: 'Harry Potter Style',
                image: 'https://images.unsplash.com/photo-1542206391-7f9492806141?q=80&w=1287&auto=format&fit=crop',
                prompt: 'Transform the subject into a character from the Harry Potter universe, matching them to the Hogwarts house they visually belong to based on aura and style. Cinematic Harry Potter film look, detailed, realistic portrait lighting. Dress the subject in Hogwarts uniform with colored robes. 4k resolution.',
                category: 'NanoBanana',
            },
            {
                id: '2',
                title: 'Winter Aesthetic',
                image: 'https://images.unsplash.com/photo-1483985988355-763728e1935b?q=80&w=2070&auto=format&fit=crop',
                prompt: 'A hyper-realistic portrait of a girl in a snowy forest, wearing a green puffer jacket and beanie. Soft morning sunlight filtering through trees, mist, frost on eyelashes, 8k resolution, cinematic depth of field.',
                category: 'Midjourney',
            }
        ];

        // --- Components ---

        const Tag = ({ category }) => {
            let colorClass = "text-white";
            let dotColor = "bg-white";

            if (category === 'NanoBanana') {
                colorClass = "text-yellow-400";
                dotColor = "bg-yellow-400";
            } else if (category === 'Midjourney') {
                colorClass = "text-blue-400";
                dotColor = "bg-blue-400";
            } else if (category === 'Seedream') {
                colorClass = "text-green-400";
                dotColor = "bg-green-400";
            }

            return (
                <div className="flex items-center gap-2 bg-black/40 px-3 py-1.5 rounded-full border border-white/10 w-fit">
                    <span className={`w-2 h-2 rounded-full ${dotColor}`}></span>
                    <span className={`text-xs font-y2k font-bold uppercase tracking-wider ${colorClass}`}>{category}</span>
                </div>
            );
        };

        const App = () => {
            // --- STORAGE LOGIC ---
            const [prompts, setPrompts] = useState(() => {
                const saved = localStorage.getItem('zigZagPrompts_v2'); 
                if (saved) {
                    return JSON.parse(saved);
                } else {
                    return defaultPrompts;
                }
            });

            useEffect(() => {
                localStorage.setItem('zigZagPrompts_v2', JSON.stringify(prompts));
            }, [prompts]);

            const [view, setView] = useState('gallery'); 
            const [activePrompt, setActivePrompt] = useState(null);
            const [filter, setFilter] = useState('All');
            const [search, setSearch] = useState('');
            const [isSharedMode, setIsSharedMode] = useState(false);

            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const sharedId = params.get('share');
                
                if (sharedId) {
                    const found = prompts.find(p => p.id === sharedId);
                    if (found) {
                        setActivePrompt(found);
                        setView('full');
                        setIsSharedMode(true);
                    }
                }
                lucide.createIcons();
            }, []);

            useEffect(() => {
                lucide.createIcons();
            }, [view, prompts, filter, search]);

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text);
                const btn = document.getElementById('copyBtn');
                if(btn) {
                    const original = btn.innerHTML;
                    btn.innerHTML = `<i data-lucide="check" class="w-4 h-4"></i> Copied!`;
                    lucide.createIcons();
                    setTimeout(() => {
                        btn.innerHTML = original;
                        lucide.createIcons();
                    }, 2000);
                }
            };

            const sharePrompt = (id) => {
                const url = `${window.location.origin}${window.location.pathname}?share=${id}`;
                navigator.clipboard.writeText(url);
                alert("Share link copied!");
            };

            const handleSave = (newPrompt) => {
                if (view === 'add') {
                    setPrompts([...prompts, { ...newPrompt, id: Date.now().toString() }]);
                } else if (view === 'edit') {
                    setPrompts(prompts.map(p => p.id === activePrompt.id ? { ...newPrompt, id: activePrompt.id } : p));
                }
                setView('gallery');
                setActivePrompt(null);
            };

            // --- Logic for Filter + Search ---
            const filteredPrompts = prompts.filter(p => {
                const matchesCategory = filter === 'All' || p.category === filter;
                const matchesSearch = p.title.toLowerCase().includes(search.toLowerCase()) || 
                                      p.prompt.toLowerCase().includes(search.toLowerCase());
                return matchesCategory && matchesSearch;
            });

            // Helper for Button Colors
            const getCategoryButtonStyle = (cat, isActive) => {
                const base = "px-4 py-2 rounded-full text-xs font-y2k uppercase transition-all whitespace-nowrap border shrink-0 ";
                
                if (!isActive) return base + "bg-transparent text-gray-400 border-gray-700 hover:border-gray-500";

                switch(cat) {
                    case 'NanoBanana': return base + "bg-yellow-400 text-black border-yellow-400 shadow-[0_0_10px_rgba(250,204,21,0.4)]";
                    case 'Midjourney': return base + "bg-blue-500 text-white border-blue-500 shadow-[0_0_10px_rgba(59,130,246,0.4)]";
                    case 'Seedream': return base + "bg-green-500 text-black border-green-500 shadow-[0_0_10px_rgba(34,197,94,0.4)]";
                    default: return base + "bg-white text-black border-white";
                }
            };

            // --- FULL VIEW ---
            if (view === 'full' && activePrompt) {
                return (
                    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/95 p-4 overflow-y-auto">
                        <div className="w-full max-w-lg glass-panel rounded-3xl overflow-hidden relative flex flex-col max-h-[90vh]">
                            
                            <div className="absolute top-0 left-0 right-0 z-10 p-6 flex justify-between items-start bg-gradient-to-b from-black/80 to-transparent">
                                {!isSharedMode && (
                                    <button 
                                        onClick={() => { setView('gallery'); setActivePrompt(null); }}
                                        className="w-10 h-10 rounded-full glass-button flex items-center justify-center text-white"
                                    >
                                        <i data-lucide="arrow-left" className="w-5 h-5"></i>
                                    </button>
                                )}
                                <div className="flex-1"></div>
                            </div>

                            <div className="overflow-y-auto custom-scrollbar pb-24">
                                <div className="relative w-full aspect-ratio-4-5 bg-gray-900">
                                    <img 
                                        src={activePrompt.image} 
                                        alt={activePrompt.title} 
                                        className="w-full h-full object-cover"
                                        onError={(e) => {e.target.src = 'https://via.placeholder.com/400x500?text=No+Image'}}
                                    />
                                </div>

                                <div className="p-6 space-y-4">
                                    <div className="flex flex-col items-center justify-center gap-2 mb-2">
                                         {/* Updated Logo in Modal */}
                                         <div className="w-12 h-12 rounded-lg bg-black/20 flex items-center justify-center overflow-hidden border border-white/10">
                                            <img src="https://i.postimg.cc/d36yztYk/image-(2).png" alt="Logo" className="w-full h-full object-cover" />
                                         </div>
                                         <h1 className="text-2xl font-y2k font-bold text-center">{activePrompt.title}</h1>
                                    </div>

                                    <div className="flex justify-center"><Tag category={activePrompt.category} /></div>
                                    
                                    <div className="glass-panel p-4 rounded-xl mt-4">
                                        <p className="text-gray-300 text-sm leading-relaxed font-light">
                                            {activePrompt.prompt}
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <div className="absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black via-black/90 to-transparent">
                                <button 
                                    id="copyBtn"
                                    onClick={() => copyToClipboard(activePrompt.prompt)}
                                    className="w-full py-4 rounded-full font-bold font-body text-white flex items-center justify-center gap-2 hover:opacity-90 transition-opacity"
                                    style={{ backgroundColor: '#5C5CFF' }}
                                >
                                    <i data-lucide="copy" className="w-4 h-4"></i>
                                    Copy Prompt
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            if (view === 'add' || view === 'edit') {
                return <PromptForm 
                    initialData={view === 'edit' ? activePrompt : null} 
                    onSave={handleSave} 
                    onCancel={() => setView('gallery')} 
                />
            }

            if (isSharedMode) return null; 

            return (
                <div className="min-h-screen pb-20 p-4 md:p-6 max-w-7xl mx-auto">
                    {/* Mobile Header - Updated Logo & Title */}
                    <header className="flex justify-between items-center mb-6 sticky top-0 z-40 bg-[#050505]/80 backdrop-blur-md py-4 -mx-4 px-4 border-b border-white/5">
                        <div className="flex items-center gap-3">
                            <img 
                                src="https://i.postimg.cc/d36yztYk/image-(2).png" 
                                alt="PromptVault" 
                                className="w-10 h-10 object-contain rounded-lg"
                            />
                            <span className="text-2xl font-y2k font-bold tracking-tight">PromptVault</span>
                        </div>
                        <button 
                            onClick={() => setView('add')}
                            className="px-4 py-2 rounded-full glass-button text-xs font-medium flex items-center gap-2"
                        >
                            <i data-lucide="plus" className="w-4 h-4"></i>
                            ADD
                        </button>
                    </header>

                    {/* Controls Row: Filters + Search */}
                    <div className="flex flex-row items-center gap-3 mb-6">
                        
                        {/* Scrollable Filters */}
                        <div className="flex-1 flex gap-2 overflow-x-auto no-scrollbar mask-gradient">
                            {['All', 'NanoBanana', 'Midjourney', 'Seedream'].map(cat => (
                                <button
                                    key={cat}
                                    onClick={() => setFilter(cat)}
                                    className={getCategoryButtonStyle(cat, filter === cat)}
                                >
                                    {cat}
                                </button>
                            ))}
                        </div>

                        {/* Search Bar */}
                        <div className="relative w-1/3 min-w-[120px] max-w-[180px]">
                            <input 
                                type="text" 
                                placeholder="Search..." 
                                value={search}
                                onChange={(e) => setSearch(e.target.value)}
                                className="w-full bg-white/5 border border-white/10 rounded-full py-2 pl-9 pr-3 text-xs text-white focus:outline-none focus:border-white/30 transition-colors"
                            />
                            <i data-lucide="search" className="absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"></i>
                        </div>
                    </div>

                    {/* Grid */}
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        {filteredPrompts.length === 0 && (
                            <div className="text-center py-20 text-gray-500 col-span-full font-light text-sm">
                                No prompts found matching your search.
                            </div>
                        )}
                        {filteredPrompts.map(item => (
                            <div key={item.id} className="flex flex-col gap-3 group">
                                <div 
                                    onClick={() => { setActivePrompt(item); setView('full'); }}
                                    className="glass-panel rounded-3xl overflow-hidden aspect-ratio-4-5 relative cursor-pointer active:opacity-90 transition-all"
                                >
                                    <img 
                                        src={item.image} 
                                        alt={item.title} 
                                        className="w-full h-full object-cover"
                                        onError={(e) => {e.target.src = 'https://via.placeholder.com/400x500?text=No+Image'}}
                                    />
                                    <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60"></div>
                                    
                                    <div className="absolute bottom-0 left-0 p-4 w-full">
                                        <h3 className="font-y2k text-lg leading-tight mb-2 truncate">{item.title}</h3>
                                        <Tag category={item.category} />
                                    </div>
                                </div>

                                <div className="flex gap-2 px-1">
                                    <button 
                                        onClick={() => { setActivePrompt(item); setView('edit'); }}
                                        className="flex-1 py-3 rounded-xl glass-button flex items-center justify-center gap-2 text-xs text-gray-300"
                                    >
                                        <i data-lucide="edit-3" className="w-3 h-3"></i>
                                        Edit
                                    </button>
                                    <button 
                                        onClick={() => sharePrompt(item.id)}
                                        className="flex-1 py-3 rounded-xl glass-button flex items-center justify-center gap-2 text-xs text-gray-300"
                                    >
                                        <i data-lucide="share-2" className="w-3 h-3"></i>
                                        Share
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const PromptForm = ({ initialData, onSave, onCancel }) => {
            const [formData, setFormData] = useState(initialData || {
                title: '',
                prompt: '',
                image: '',
                category: 'NanoBanana'
            });

            return (
                <div className="min-h-screen p-4 flex flex-col max-w-2xl mx-auto bg-[#050505]">
                    <div className="flex items-center justify-between mb-6">
                        <h2 className="text-xl font-y2k">{initialData ? 'Edit Prompt' : 'New Prompt'}</h2>
                        <button onClick={onCancel} className="p-2 bg-white/5 rounded-full"><i data-lucide="x" className="w-5 h-5"></i></button>
                    </div>
                    
                    <div className="space-y-5 flex-1 overflow-y-auto pb-10">
                        <div>
                            <label className="block text-xs text-gray-400 mb-2 uppercase tracking-wider">Title</label>
                            <input 
                                type="text" 
                                className="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:outline-none focus:border-[#5C5CFF]"
                                value={formData.title}
                                onChange={e => setFormData({...formData, title: e.target.value})}
                                placeholder="e.g. Cyberpunk City"
                            />
                        </div>

                        <div>
                            <label className="block text-xs text-gray-400 mb-2 uppercase tracking-wider">Image URL</label>
                            <input 
                                type="text" 
                                className="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:outline-none focus:border-[#5C5CFF]"
                                value={formData.image}
                                onChange={e => setFormData({...formData, image: e.target.value})}
                                placeholder="Paste image link here"
                            />
                        </div>

                         <div>
                            <label className="block text-xs text-gray-400 mb-2 uppercase tracking-wider">Category</label>
                            <div className="flex flex-wrap gap-2">
                                {['NanoBanana', 'Midjourney', 'Seedream'].map(cat => (
                                    <button
                                        key={cat}
                                        onClick={() => setFormData({...formData, category: cat})}
                                        className={`px-4 py-3 rounded-lg text-xs border flex-1 text-center transition-colors ${
                                            formData.category === cat 
                                            ? (cat === 'NanoBanana' ? 'bg-yellow-400 text-black border-yellow-400' : 
                                               cat === 'Midjourney' ? 'bg-blue-500 text-white border-blue-500' :
                                               cat === 'Seedream' ? 'bg-green-500 text-black border-green-500' : 'bg-white text-black')
                                            : 'bg-transparent border-white/10 text-gray-500'
                                        }`}
                                    >
                                        {cat}
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div>
                            <label className="block text-xs text-gray-400 mb-2 uppercase tracking-wider">Prompt</label>
                            <textarea 
                                className="w-full h-40 bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:outline-none focus:border-[#5C5CFF] resize-none"
                                value={formData.prompt}
                                onChange={e => setFormData({...formData, prompt: e.target.value})}
                                placeholder="Enter prompt details..."
                            ></textarea>
                        </div>
                    </div>

                    <div className="pt-4 pb-8">
                        <button 
                            onClick={() => onSave(formData)}
                            className="w-full py-4 rounded-full text-white font-bold text-lg shadow-lg shadow-blue-900/50"
                            style={{ backgroundColor: '#5C5CFF' }}
                        >
                            Save Prompt
                        </button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
